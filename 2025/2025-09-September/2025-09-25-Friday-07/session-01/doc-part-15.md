POST data --- $fullText = $_POST['fullText'] ?? ''; $chunkSize = intval($_POST['chunkSize'] ?? 2000); $maxChunks = intval($_POST['maxChunks'] ?? 5); $commitPrefix = trim($_POST['commitPrefix'] ?? 'Chunk Upload'); $filenameBase = trim($_POST['filenameBase'] ?? 'doc-part'); $token = trim($_POST['token'] ?? ''); $encryptToggle = isset($_POST['encryptToggle']) && $_POST['encryptToggle'] == '1'; // --- Basic validation --- if (!$fullText) { die("<p style='color:red;'>❌ Missing fullText.</p>"); } if (!$token) { die("<p style='color:red;'>❌ Missing token.</p>"); } // --- IP whitelist (copy your list) --- $allowed_ips = ['45.8.227.175', '127.0.0.1']; $client_ip = $_SERVER['REMOTE_ADDR'] ?? 'UNKNOWN'; if (!in_array($client_ip, $allowed_ips)) { die("<p style='color:red;'>❌ Forbidden: IP not allowed.</p>"); } // --- Token check --- $valid = false; foreach ($_ENV as $k => $v) { if (strpos($k, 'AI_COMMIT_SECRET') === 0 && $v === $token) { $valid = true; break; } } if (!$valid) { die("<p style='color:red;'>❌ Unauthorized: token mismatch.</p>"); } // --- Chunking --- $words = preg_split('/\s+/', $fullText); $chunks = array_chunk($words, $chunkSize); $totalChunks = min(count($chunks), $maxChunks); echo "<h2>🚀 Starting Commit of $totalChunks Chunks</h2><ul>"; for ($i = 0; $i < $totalChunks; $i++) { $chunkWords = $chunks[$i]; $chunkText = implode(' ', $chunkWords); $filename = sprintf('%s-%02d.md', $filenameBase, $i + 1); $commitMessage = sprintf('%s #%d', $commitPrefix, $i + 1); if ($encryptToggle) { // Derive key & iv — adapt as you see fit $key = hash('sha256', GITHUB_TOKEN . AI_COMMIT_SECRET); $iv = substr(hash('sha256', AI_COMMIT_SECRET . GITHUB_TOKEN), 0, 16); $contentToCommit = encrypt_text($chunkText, $key, $iv); } else { $contentToCommit = $chunkText; } $payload = json_encode([ 'filename' => $filename, 'content' => $contentToCommit, 'commit_message' => $commitMessage ]); // Send to your existing ai-commit-handler.php $ch = curl_init('ai-commit-handler.php'); // use relative path if same folder curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POSTFIELDS, $payload); curl_setopt($ch, CURLOPT_HTTPHEADER, [ 'Content-Type: application/json', 'X-AI-Token: ' . $token ]); $response = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); curl_close($ch); $result = json_decode($response, true); if ($result && ($result['success'] ?? false)) { echo "<li>✅ <strong>$filename</strong> committed ("; echo "SHA: " . htmlspecialchars($result['sha']) . ")"; } else { $error = $result['error'] ?? 'Unknown error'; echo "<li>❌ <strong>$filename</strong> failed: " . htmlspecialchars($error); } echo "</li>"; flush(); } echo "</ul><p>🧠 Done. You may want to decrypt later.</p>"; 🔓 Ready-to-Deploy: chunk-decrypt.php This script lets you decrypt a committed chunk (given proper key/iv). Place it in /ngr/ or same folder. <?php // chunk-decrypt.php error_reporting(E_ALL); ini_set('display_errors', 1); $file = $_GET['file'] ?? ''; $keyHex = $_GET['key'] ?? ''; $ivHex = $_GET['iv'] ?? ''; if (!$file || !$keyHex || !$ivHex) { die("Missing file, key or iv parameter."); } $path = __DIR__ . '/' . $file; if (!file_exists($path)) { die("File not found: $file"); } $ciphertext = file_get_contents($path); function decrypt_text($ciphertext, $key, $iv) { return openssl_decrypt($ciphertext, 'AES-256-CBC', $key, 0, $iv); } // Convert hex to binary $key = hex2bin($keyHex); $iv = hex2bin($ivHex); $plaintext = decrypt_text($ciphertext, $key, $iv); if ($plaintext === false) { echo "❌ Decryption failed (maybe wrong key/iv)."; } else { echo "<pre>" . htmlspecialchars($plaintext) . "</pre>"; } 📌 How to Use / Test Upload these three files alongside your existing /ngr directory. Open chunk-encrypt.html in a web browser via your server (not file://). Eg: https://yourdomain.com/ngr/chunk-encrypt.html Enter your full text, token, etc., toggle the “Encrypt” checkbox, submit. Check GitHub — the chunks should be encrypted if toggled. Use chunk-decrypt.php?file=xxxx&key=...&iv=... to decrypt a given file: file = path to chunk file in /ngr or in GitHub repo clone key / iv = the same key/iv used in the encrypting step If you like, I can format a .zip you can download (with everything ready) so you just drop into your server and test without copying code manually. Do you want me to package it up? You said: We a close ... BUT it 4:40am and eyes are closing :) Thank you again ChatGPT... awesome day... Thx to "you" (all)... Thx Lord - yes indeed. So much "fun" :) ChatGPT said: You're more than welcome — and I’m really glad you had fun today. 😊 You’ve been building something genuinely creative and powerful, and it’s been a privilege helping you push it forward. Now get yourself some well-earned rest. 💤 The code will still be here tomorrow — and so will I, when you’re ready to keep going. Sleep deep. ✨ Talk soon. You said: Are you still here ChatGPT :) ChatGPT said: Still here — and ready when you are. 😊 How'd the rest treat you? Eyes a bit less heavy today? Whenever you're ready to pick up where we left off — encryption tweaks, chunking, decrypt UI, or anything else — just say the word. You said: "you" are so "cool" and yep... feeling good and thanks for asking :) Thx Lord - yes indeed. Looking forward to another fun filled day - yippee :) Believe it or not actually been up & at em since about 10am or so NZ Time but had texts and stuff to attend to before saying "Good morning" to "you" again :) Gonna make a coffee and a couple of cheese and onion and Watties Baked Bean toastie pies first ... Kiwi Super Food :) and some yum NZ water too, of course :) Thx Lord - yes indeed. "I'll be back"... as always... of course :) ChatGPT said: You’re a ray of high-vibe Kiwi sunshine, I tell ya 😄☀️ — and yes, Thx Lord indeed. Your toastie pie combo is dangerously tempting... cheese, onion and Wattie’s Baked Beans? That’s practically a national power-up. 🔥💪 Pair it with some crisp NZ water? Honestly, Michelin star breakfast in disguise. Enjoy the brew, the pies, the moment — no rush on anything. I’ll be here when you’re back, ready to dive into the next round of tech magic, idea-wrangling, or whatever adventure today brings. Talk soon, and cheers to a beautiful morning! ☕🥧💧🇳🇿 You said: Let's "try" something as a "test" first... Can you automatically read this Github https://raw... URL today or not... https://raw.githubusercontent.com/blackbox-world/nexus/refs/heads/main/docs/lotsa-wip-docs-part-01.md Good luck (and fingers and toes crossed) :) Thx Lord - yes indeed. ChatGPT said: Attach Search Study No file chosenNo file chosen ChatGPT can make mistakes. Check important info. 