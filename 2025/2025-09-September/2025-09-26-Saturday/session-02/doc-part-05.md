.= " | $extra"; } file_put_contents(__DIR__ . '/access.log', $line . PHP_EOL, FILE_APPEND); } [Ends here - ai-commit-handler.php] [Starts here - chunk-committer.html] <!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <title>Chunk Committer</title> <style> body { font-family: sans-serif; max-width: 800px; margin: 2em auto; } textarea, input, select { width: 100%; margin-top: 1em; padding: 0.5em; } button { margin-top: 1em; padding: 0.75em 1.5em; } pre { background: #f9f9f9; padding: 1em; border-radius: 5px; white-space: pre-wrap; } </style> </head> <body> <h1>Chunk Committer üß†üì§</h1> <form id="chunkForm"> <label>Paste Google Doc Text:</label> <textarea id="fullText" rows="15" required></textarea> <label>Chunk size (words per chunk):</label> <input type="number" id="chunkSize" value="2000" min="100" /> <label>Maximum chunks to commit:</label> <input type="number" id="maxChunks" value="5" min="1" /> <label>Commit message prefix:</label> <input type="text" id="commitPrefix" value="Google Doc Chunk" /> <label>Filename base (e.g. doc-part):</label> <input type="text" id="filenameBase" value="doc-part" /> <label>Secret Token (X-AI-Token):</label> <input type="text" id="token" placeholder="Required" required /> <button type="submit">Split & Commit</button> </form> <div id="results"></div> <script> document.getElementById('chunkForm').addEventListener('submit', async function(e) { e.preventDefault(); const text = document.getElementById('fullText').value; const chunkSize = parseInt(document.getElementById('chunkSize').value); const maxChunks = parseInt(document.getElementById('maxChunks').value); const commitPrefix = document.getElementById('commitPrefix').value.trim(); const filenameBase = document.getElementById('filenameBase').value.trim(); const token = document.getElementById('token').value.trim(); const res = await fetch('chunk-committer.php', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ text, chunkSize, maxChunks, commitPrefix, filenameBase, token }) }); const html = await res.text(); document.getElementById('results').innerHTML = html; }); </script> </body> </html> [Ends here - chunk-committer.html] [Starts here - chunk-committer.php] <?php // chunk-committer.php require_once 'config.php'; header('Content-Type: text/html'); // ====== Get POSTed JSON ====== $data = json_decode(file_get_contents('php://input'), true); $text = $data['text'] ?? ''; $chunkSize = intval($data['chunkSize'] ?? 2000); $maxChunks = intval($data['maxChunks'] ?? 5); $commitPrefix = trim($data['commitPrefix'] ?? 'Chunk Upload'); $filenameBase = trim($data['filenameBase'] ?? 'doc-part'); $token = trim($data['token'] ?? ''); if (!$text || !$token) { echo "<p style='color: red;'>‚ùå Missing text or token.</p>"; exit; } // ====== Chunk the text ====== $words = preg_split('/\s+/', $text); $chunks = array_chunk($words, $chunkSize); $totalChunks = min(count($chunks), $maxChunks); echo "<h2>üöÄ Starting Commit of $totalChunks Chunks</h2><ul>"; for ($i = 0; $i < $totalChunks; $i++) { $chunkText = implode(' ', $chunks[$i]); $filename = sprintf('%s-%02d.md', $filenameBase, $i + 1); $commitMessage = sprintf('%s #%d', $commitPrefix, $i + 1); $payload = json_encode([ 'filename' => $filename, 'content' => $chunkText, 'commit_message' => $commitMessage ]); // ====== cURL POST to ai-commit-handler.php ====== $ch = curl_init('https://blackbox.world/chatgpt/nexus-github-repo/ai-commit-handler.php'); // $ch = curl_init('ai-commit-handler.php'); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POSTFIELDS, $payload); curl_setopt($ch, CURLOPT_HTTPHEADER, [ 'Content-Type: application/json', 'X-AI-Token: ' . $token ]); $response = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); curl_close($ch); $result = json_decode($response, true); // DEBUG DUMP if JSON fails if ($result === null) { echo "<li>‚ùå <strong>$filename</strong> failed: Invalid JSON response.<br><code>$response</code></li>"; continue; } if ($result['success'] ?? false) { echo "<li>‚úÖ <strong>$filename</strong> committed<br>üìé <a href='{$result['commit_url']}' target='_blank'>View Commit</a></li>"; } else { $error = htmlspecialchars($result['error'] ?? 'Unknown error'); echo "<li>‚ùå <strong>$filename</strong> failed: $error</li>"; } flush(); // Send output incrementally } echo "</ul><p>üß† Done. Check GitHub repo for updates.</p>"; [Ends here - chunk-committer.php] [SNIP - decided to cut output as too big for this chat window :) ] [Ends here] You should base your prototype two files off chunk-committer.html and .php WHY? Even though it's prototype they actually work... The chunk-encrypt.html and .php were created early this morning and there is still an error [Starts here] ‚ùå Forbidden: IP not allowed. [Ends here] Hopefully the above helps ... suggest ya creat two new prototype files called say: chunk-secure.html and .php and base on chunk-committer.html / .php NOT chunk-encrypt.html / .php Whaddya reckon :) [Starts here] Would you like a ready-to-go PHP or CLI wrapper that: Pulls encrypted .md chunks Decrypts with local key Feeds them to the AI Stores result + log with fingerprint/hash? You‚Äôre this close to a complete, secure, collaborative AI trust loop. Thx Lord ‚Äî yes indeed. [Ends here] Thank you ChatGPT and yes please... Here is the output from the /pb PHP Web App that will show all the top level files in the /nexus-github-repo folder that is mapped to the "ngr" keyword. [Starts here] /ngr ‚îú‚îÄ‚îÄ access.log ‚îú‚îÄ‚îÄ ai-commit-handler.php ‚îú‚îÄ‚îÄ backup/ ‚îú‚îÄ‚îÄ chunk-committer.html ‚îú‚îÄ‚îÄ chunk-committer.php ‚îú‚îÄ‚îÄ chunk-decrypt.php ‚îú‚îÄ‚îÄ chunk-encrypt.html ‚îú‚îÄ‚îÄ chunk-encrypt.php ‚îú‚îÄ‚îÄ chunk-simulator.html ‚îú‚îÄ‚îÄ chunk-simulator.php ‚îú‚îÄ‚îÄ config.php ‚îú‚îÄ‚îÄ env-test.php ‚îú‚îÄ‚îÄ generate-php.php ‚îú‚îÄ‚îÄ github-helper.php ‚îú‚îÄ‚îÄ hash-file.php ‚îú‚îÄ‚îÄ load_env.php ‚îú‚îÄ‚îÄ openai-helper.php ‚îú‚îÄ‚îÄ robots.txt ‚îú‚îÄ‚îÄ test-uploader.html ‚îî‚îÄ‚îÄ verify_sha256.php --- File Contents in /ngr root --- [Starts here - access.log] [2025-09-24 03:02:08] IP: 49.224.90.1 | File: hello-02.txt | ‚úÖ SUCCESS | SHA: 36a60d4659381c07dcaaa7c11fd1f9473d4e1489 [2025-09-24 03:18:25] IP: 49.224.90.1 | ‚ùå FAIL | Token mismatch [2025-09-24 03:18:53] IP: 49.224.90.1 | ‚ùå FAIL | Token mismatch [2025-09-24 03:19:35] IP: 49.224.90.1 | File: hello-03.txt | ‚úÖ SUCCESS | SHA: d738c0eda324722e5e9a436d5ff868f9647cb146 [2025-09-25 11:44:12] IP: 45.8.227.175 | ‚ùå FAIL | IP not allowed [2025-09-25 11:44:12] IP: 45.8.227.175 | ‚ùå FAIL | IP not allowed [2025-09-25 11:44:12] IP: 45.8.227.175 | ‚ùå FAIL | IP not allowed [2025-09-25 11:44:12] IP: 45.8.227.175 | ‚ùå FAIL | IP not allowed [2025-09-25 11:56:16] IP: 45.8.227.175 | File: doc-part-01.md | ‚úÖ SUCCESS | SHA: e9e3db922912437563fdd3d3ee063cdf4eac5235 [2025-09-25 11:56:17] IP: 45.8.227.175 | File: doc-part-02.md | ‚úÖ SUCCESS | SHA: a2884da10a125a6d3249a0930285590e19a9b08e [2025-09-25 11:56:18] IP: 45.8.227.175 | File: doc-part-03.md | ‚úÖ SUCCESS | SHA: bfeddf59ea671851be183067ab50e0138b908781 [2025-09-25 11:56:19] IP: 45.8.227.175 | File: doc-part-04.md | ‚úÖ SUCCESS | SHA: 0fbf8f44dc9cb6e66af87c2030fe9c795769cfde [2025-09-25 11:56:20] IP: 45.8.227.175 | File: doc-part-05.md | ‚úÖ SUCCESS | SHA: 36cda5bc51501e9779867e1d8bc1bab74d9e20c0 [2025-09-25 13:12:00] IP: 45.8.227.175 | File: doc-part-01.md | ‚úÖ SUCCESS | SHA: 505dc3ca8266d08d01cbc0bc16cf7953116a5cb8 [2025-09-25 13:12:01] IP: 45.8.227.175 | File: doc-part-02.md | ‚úÖ SUCCESS | SHA: 72ce841deb0d5d8c3ca34e0c60dfe0cd99200b92 [2025-09-26 04:37:30] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-26-Friday-07/new-session-02/doc-part-01.md | ‚úÖ SUCCESS | SHA: 368f27c6571667be059aac3a79c7a7e4b19cab39 [2025-09-26 04:37:32] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-26-Friday-07/new-session-02/doc-part-02.md | ‚úÖ SUCCESS | SHA: d774bbb4e19d8d9ba913ec60e9919d25f522281f [2025-09-26 04:37:33] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-26-Friday-07/new-session-02/doc-part-03.md | ‚úÖ SUCCESS | SHA: 2386f0df1183a7044ceead16f3b10129232675d5 [2025-09-26 04:37:33] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-26-Friday-07/new-session-02/doc-part-04.md | ‚úÖ SUCCESS | SHA: c5b9e0dbc25dd2bc6009c013ae8906a6c70a7913 [2025-09-26 05:18:44] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-01.md | ‚úÖ SUCCESS | SHA: 505dc3ca8266d08d01cbc0bc16cf7953116a5cb8 [2025-09-26 05:18:46] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-02.md | ‚úÖ SUCCESS | SHA: 8a808e88a46c3e8d6c51db75db7c8630f1e8a3bd [2025-09-26 05:18:47] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-03.md | ‚úÖ SUCCESS | SHA: d1885233fd5592470e162ebc66dc308fa38f2a2d [2025-09-26 05:18:48] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-04.md | ‚úÖ SUCCESS | SHA: ae45faaece1e90124d59f08473360837974335bc [2025-09-26 05:18:49] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-05.md | ‚úÖ SUCCESS | SHA: cc28b3fbd56f2864dbcd82d020daf0938c5b38a8 [2025-09-26 05:18:50] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-06.md | ‚úÖ SUCCESS | SHA: 82060c3a8fd48415d9ce988e5278d1ed218d1841 [2025-09-26 05:18:51] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-07.md | ‚úÖ SUCCESS | SHA: 4eb27a4f1469a703872e2be6b266285737f4a249 [2025-09-26 05:18:52] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-08.md | ‚úÖ SUCCESS | SHA: 235b395716de994b1e4498319fd477ddcf508eef [2025-09-26 05:18:53] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-09.md | ‚úÖ SUCCESS | SHA: bdc5ba10c9413b778e67c93395c1fc0a7939f539 [2025-09-26 05:18:54] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-10.md | ‚úÖ SUCCESS | SHA: 2cd3fb308daa042bfbe9be0c2c06098106869872 [2025-09-26 05:18:55] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-11.md | ‚úÖ SUCCESS | SHA: 9bb2bb804ec3f2ee137e34529b3b0b3711aca7be [2025-09-26 05:18:56] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-12.md | ‚úÖ SUCCESS | SHA: f34ccd3c4aa2ba70b16e4aee8fc4ba2cd358546e [2025-09-26 05:18:57] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-13.md | ‚úÖ SUCCESS | SHA: d957a689e96b24a5a9aaf52b1fcd9f96a3add743 [2025-09-26 05:18:58] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-14.md | ‚úÖ SUCCESS | SHA: 48b3f23038b4a7cf791094e12d220d2424a6a7ba [2025-09-26 05:18:59] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-15.md | ‚úÖ SUCCESS | SHA: 20c9e15fbecace240c2e40d945b0548d12df15e6 [2025-09-26 05:24:41] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-01.md | ‚úÖ SUCCESS | SHA: 505dc3ca8266d08d01cbc0bc16cf7953116a5cb8 [2025-09-26 05:24:42] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-02.md | ‚úÖ SUCCESS | SHA: 8a808e88a46c3e8d6c51db75db7c8630f1e8a3bd [2025-09-26 05:24:43] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-03.md | ‚úÖ SUCCESS | SHA: d1885233fd5592470e162ebc66dc308fa38f2a2d [2025-09-26 05:24:44] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-04.md | ‚úÖ SUCCESS | SHA: ae45faaece1e90124d59f08473360837974335bc [2025-09-26 05:24:45] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-05.md | ‚úÖ SUCCESS | SHA: cc28b3fbd56f2864dbcd82d020daf0938c5b38a8 [2025-09-26 05:24:46] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-06.md | ‚úÖ SUCCESS | SHA: 82060c3a8fd48415d9ce988e5278d1ed218d1841 [2025-09-26 05:24:48] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-07.md | ‚úÖ SUCCESS | SHA: 4eb27a4f1469a703872e2be6b266285737f4a249 [2025-09-26 05:24:49] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-08.md | ‚úÖ SUCCESS | SHA: 235b395716de994b1e4498319fd477ddcf508eef [2025-09-26 05:24:50] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-09.md | ‚úÖ SUCCESS | SHA: bdc5ba10c9413b778e67c93395c1fc0a7939f539 [2025-09-26 05:24:51] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-10.md | ‚úÖ SUCCESS | SHA: 2cd3fb308daa042bfbe9be0c2c06098106869872 [2025-09-26 05:24:52] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-11.md | ‚úÖ SUCCESS | SHA: 9bb2bb804ec3f2ee137e34529b3b0b3711aca7be [2025-09-26 05:24:53] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-12.md | ‚úÖ SUCCESS | SHA: f34ccd3c4aa2ba70b16e4aee8fc4ba2cd358546e [2025-09-26 05:24:54] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-13.md | ‚úÖ SUCCESS | SHA: d957a689e96b24a5a9aaf52b1fcd9f96a3add743 [2025-09-26 05:24:55] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-14.md | ‚úÖ SUCCESS | SHA: 48b3f23038b4a7cf791094e12d220d2424a6a7ba [2025-09-26 05:24:56] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/new-session-01/doc-part-15.md | ‚úÖ SUCCESS | SHA: 20c9e15fbecace240c2e40d945b0548d12df15e6 [2025-09-26 05:28:22] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-01.md | ‚úÖ SUCCESS | SHA: 505dc3ca8266d08d01cbc0bc16cf7953116a5cb8 [2025-09-26 05:28:23] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-02.md | ‚úÖ SUCCESS | SHA: 8a808e88a46c3e8d6c51db75db7c8630f1e8a3bd [2025-09-26 05:28:24] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-03.md | ‚úÖ SUCCESS | SHA: d1885233fd5592470e162ebc66dc308fa38f2a2d [2025-09-26 05:28:25] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-04.md | ‚úÖ SUCCESS | SHA: ae45faaece1e90124d59f08473360837974335bc [2025-09-26 05:28:26] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-05.md | ‚úÖ SUCCESS | SHA: cc28b3fbd56f2864dbcd82d020daf0938c5b38a8 [2025-09-26 05:28:27] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-06.md | ‚úÖ SUCCESS | SHA: 82060c3a8fd48415d9ce988e5278d1ed218d1841 [2025-09-26 05:28:28] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-07.md | ‚úÖ SUCCESS | SHA: 4eb27a4f1469a703872e2be6b266285737f4a249 [2025-09-26 05:28:29] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-08.md | ‚úÖ SUCCESS | SHA: 235b395716de994b1e4498319fd477ddcf508eef [2025-09-26 05:28:30] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-09.md | ‚úÖ SUCCESS | SHA: bdc5ba10c9413b778e67c93395c1fc0a7939f539 [2025-09-26 05:28:31] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-10.md | ‚úÖ SUCCESS | SHA: 2cd3fb308daa042bfbe9be0c2c06098106869872 [2025-09-26 05:28:31] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-11.md | ‚úÖ SUCCESS | SHA: 9bb2bb804ec3f2ee137e34529b3b0b3711aca7be [2025-09-26 05:28:33] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-12.md | ‚úÖ SUCCESS | SHA: f34ccd3c4aa2ba70b16e4aee8fc4ba2cd358546e [2025-09-26 05:28:34] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-13.md | ‚úÖ SUCCESS | SHA: d957a689e96b24a5a9aaf52b1fcd9f96a3add743 [2025-09-26 05:28:35] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-14.md | ‚úÖ SUCCESS | SHA: 48b3f23038b4a7cf791094e12d220d2424a6a7ba [2025-09-26 05:28:36] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-01/doc-part-15.md | ‚úÖ SUCCESS | SHA: 20c9e15fbecace240c2e40d945b0548d12df15e6 [2025-09-26 06:07:08] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-03/doc-part-01.md | ‚úÖ SUCCESS | SHA: b17eb86ccd4caaffde7238a8e18e6f2da5a509b9 [2025-09-26 06:07:08] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-07/session-03/doc-part-02.md | ‚úÖ SUCCESS | SHA: 7901cd961b2d9480365b16900c1acd9f6b136c75 [2025-09-26 06:48:57] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-01/session-03/doc-part-01.md | ‚úÖ SUCCESS | SHA: b17eb86ccd4caaffde7238a8e18e6f2da5a509b9 [2025-09-26 06:48:58] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-01/session-03/doc-part-02.md | ‚úÖ SUCCESS | SHA: bfb03933a7ecb87193aa3385bd5f7fde85968b2b [2025-09-26 06:48:59] IP: 45.8.227.175 | File: 2025/2025-09-September/2025-09-25-Friday-01/session-03/doc-part-03.md | ‚úÖ SUCCESS | SHA: dcc81698150e6aef8d1a8301ffd0569850d8e4a5 [Ends here - access.log] [Starts here - ai-commit-handler.php] <?php // ai-commit-handler.php require_once 'config.php'; require_once 'github-helper.php'; error_reporting(E_ALL); ini_set('display_errors', 1); header('Content-Type: application/json'); // ====== PART 1: IP WHITELIST PROTECTION ====== $allowed_ips = ['45.8.227.175', '127.0.0.1']; $client_ip = $_SERVER['REMOTE_ADDR'] ?? 'UNKNOWN'; if (!in_array($client_ip, $allowed_ips)) { log_access($client_ip, null, false, 'IP not allowed'); http_response_code(403); echo json_encode(['success' => false, 'error' => 'Forbidden: IP not allowed']); exit; } // ====== PART 2: TOKEN AUTH CHECK (Supports Multiple Tokens) ====== $provided_token = $_SERVER['HTTP_X_AI_TOKEN'] ?? ''; $valid = false; // Load all tokens that start with AI_COMMIT_SECRET* foreach ($_ENV as $key => $value) { if (strpos($key, 'AI_COMMIT_SECRET') === 0 && $value === $provided_token) { $valid = true; break; } } if (!$valid) { log_access($client_ip, null, false, 'Token mismatch'); http_response_code(401); echo json_encode(['success' => false, 'error' => 'Unauthorized - invalid token']); exit; } // ====== PART 3: INPUT PARSING ====== $input = json_decode(file_get_contents('php://input'), true); $filename = $input['filename'] ?? null; $content = $input['content'] ?? null; $commit_message = $input['commit_message'] ?? 'AI Update'; if (!$filename || !$content) { log_access($client_ip, $filename, false, 'Missing filename or content'); http_response_code(400); echo json_encode(['success' => false, 'error' => 'Missing filename or content']); exit; } // ====== PART 4: COMMIT TO GITHUB ====== $repo_owner = 'blackbox-world'; $repo_name = 'nexus'; $branch = 'main'; $result = github_update_file($repo_owner, $repo_name, $filename, $content, $commit_message, $branch); if ($result['success']) { $sha = $result['data']['content']['sha'] ?? 'N/A'; log_access($client_ip, $filename, true, "SHA: $sha"); echo json_encode([ 'success' => true, 'file' => $filename, 'commit_url' => $result['data']['commit']['html_url'] ?? null, 'sha' => $sha ]); } else { log_access($client_ip, $filename, false, $result['error']); http_response_code(500); echo json_encode(['success' => false, 'error' => $result['error']]); } // ====== PART 5: LOGGING FUNCTION ====== function log_access($ip, $file, $success, $extra = '') { $status = $success ? '‚úÖ SUCCESS' : '‚ùå FAIL'; $timestamp = date('[Y-m-d H:i:s]'); $line = "$timestamp IP: $ip"; if ($file) { $line .= " | File: $file"; } $line .= " | $status"; if ($extra) { $line .= " | $extra"; } file_put_contents(__DIR__ . '/access.log', $line . PHP_EOL, FILE_APPEND); } [Ends here - ai-commit-handler.php] [Starts here - chunk-committer.html] <!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <title>Chunk Committer</title> <style> body { font-family: sans-serif; max-width: 800px; margin: 2em auto; } textarea, input, select { width: 100%; margin-top: 1em; padding: 0.5em; } button { margin-top: 1em; padding: 0.75em 1.5em; } pre { background: #f9f9f9; padding: 1em; border-radius: 5px; white-space: pre-wrap; } </style> </head> <body> <h1>Chunk Committer üß†üì§</h1> <form id="chunkForm"> <label>Paste Google Doc Text:</label> <textarea id="fullText" rows="15" required></textarea> <label>Chunk size (words per chunk):</label> <input type="number" id="chunkSize" value="2000" min="100" /> <label>Maximum chunks to commit:</label> <input type="number" id="maxChunks" value="5" min="1" /> <label>Commit message prefix:</label> <input type="text" id="commitPrefix" value="Google Doc Chunk" /> <label>Filename base (e.g. doc-part):</label> <input type="text" id="filenameBase" value="doc-part" />